#!/usr/bin/env bash

PRGDIR="$(dirname "$(realpath "$0" 2>/dev/null || readlink -f "$0")")"
export HAZELCAST_HOME=${HAZELCAST_HOME:-$(cd "$PRGDIR/.." >/dev/null; pwd -P)}

#
function find_RUN_JAVA() {
    if [ $JAVA_HOME ] ; then
        RUN_JAVA=$JAVA_HOME/bin/java
    else
        RUN_JAVA=`which java 2>/dev/null`
    fi

    if [ -z $RUN_JAVA ] ; then
        echo "Error: Java not found. Please install Java 8 or higher in your PATH or set JAVA_HOME appropriately"
        exit 1
    fi
}

#############

find_RUN_JAVA

export CLASSPATH="$HAZELCAST_HOME/lib/**"

HZ_CMD="${RUN_JAVA} -cp ${CLASSPATH} ${JAVA_OPTS} -Dhazelcast.commandline.workingdirectory=${HAZELCAST_HOME} com.hazelcast.commandline.HazelcastCommandLine"

${HZ_CMD} "$@"
